<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
	xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
	 	http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
	 	http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0 http://aries.apache.org/schemas/blueprint-cm/blueprint-cm-1.1.0.xsd">
	<cm:property-placeholder persistent-id="org.aves.pitta.mysql.sp" update-strategy="reload">
		<cm:default-properties>
			<cm:property name="mssql.user" value="pitta"/>
			<cm:property name="mssql.pass" value="pass4pass"/>
			<cm:property name="mssql.server.hostname" value="rdsejjvy3u6zffa.mysql.rds.aliyuncs.com"/>
			<cm:property name="mssql.server.databasename" value="pitta_sp"/>
			<cm:property name="mssql.server.port" value="3306"/>
			<cm:property name="mssql.validation.query" value="select 1"/>
			<cm:property name="mssql.pool.size" value="10"/>
			<cm:property name="mssql.jndi.name" value="jdbc/transfer"/>
		</cm:default-properties>
	</cm:property-placeholder>


	<!-- The Sybase Connection Pool DataSource -->
	<bean id="mssqlDataSource"
		class="com.mysql.jdbc.jdbc2.optional.MysqlDataSource">
		<property name="user" value="${mssql.user}"/>
		<property name="password" value="${mssql.pass}" />
		<property name="serverName" value="${mssql.server.hostname}" />
		<property name="databaseName" value="${mssql.server.databasename}" />
		<property name="port" value="${mssql.server.port}" />
	</bean>

	<!-- The Pooled DataSource by using Tomcat JDBC -->
	<bean id="pooledSybaseDataSource" class="org.apache.tomcat.jdbc.pool.DataSource"
		destroy-method="close">
		<property name="dataSource" ref="mssqlDataSource" />
		<property name="validationQuery" value="${mssql.validation.query}" />
		<property name="initialSize" value="${mssql.pool.size}"/>
		<property name="testOnBorrow" value="true" />
		<property name="removeAbandoned" value="true" />
		<property name="removeAbandonedTimeout" value="60" />
		<property name="logAbandoned" value="false" />
	</bean>

	<service ref="pooledSybaseDataSource" interface="javax.sql.DataSource">
		<service-properties>
			<entry key="osgi.jndi.service.name" value="${mssql.jndi.name}" />
		</service-properties>
	</service>
</blueprint>